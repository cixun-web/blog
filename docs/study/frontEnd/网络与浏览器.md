# 网络与浏览器

## TCP 协议

### 三次握手

- 客户端发送一个带有 SYN 标志的包到服务器，请求建立一个连接
- 服务器发回一个带有 SYN/ACK 标志的包以确认连接请求，同时将确认信息发送给客户端
- 客户端发送一个带有确认信息标志的包，此包发送完毕，客户端到服务器的连接就建立了

### 四次挥手

- 客户端发送一个带有 FIN 标志的包到服务器，请求关闭连接
- 服务器发回一个带有 ACK 标志的包以确认连接请求
- 服务器发送一个带有 FIN 标志的包到客户端，请求关闭连接
- 客户端发送一个带有确认信息标志的包，此包发送完毕，客户端到服务器的连接就关闭了

### 为什么需要三次握手

> 三次握手才能保证双方都有发送和接收的能力

## http协议与https协议

### 相同点

- 都是应用层协议
- 都是基于 TCP/IP 协议的
- 都是无状态的

### 不同点

- HTTPS 协议需要到 CA 申请证书，一般免费证书较少，因而需要一定费用
- HTTP 协议运行在 TCP 之上，所有传输的内容都是明文，HTTPS 运行在 SSL/TLS 之上，SSL 运行在 TCP 之上，所有传输的内容都经过加密的

## 跨域问题（同源策略）

> 跨域问题的本质是浏览器的同源策略 “协议 + 域名 + 端口”

### 什么是同源策略

- 浏览器的一种安全策略
- 不同源的客户端脚本在没有明确授权的情况下，不能读写对方资源
- 浏览器默认不发送Cookie、HTTP认证信息、SSL client certificate等

### 什么是同源

- 协议相同
- 域名相同
- 端口相同

### 跨域解决方案

- JSONP
- CORS
- postMessage
- WebSocket
- Nginx代理

### 第三方库中存在第三方的sdk跨域如何解决？

TODO

## URL 渲染全过程

- 浏览器根据输入的URL，向DNS服务器请求解析该URL的IP地址
- 浏览器向服务器发起HTTP请求
- 服务器收到请求后，返回请求的资源
- 浏览器将返回的资源进行渲染，呈现给用户

## Cookie，SessionStorage，localStorage

- Cookie
  - 存储大小限制在4kb左右
  - 每次HTTP请求都会携带Cookie信息，对于请求性能有影响
  - 只能用document.cookie来修改Cookie
- SessionStorage
  - 存储大小限制在4kb左右
  - 仅在当前会话下有效，关闭页面或浏览器后被清除
  - 只能用document.sessionStorage来修改
- localStorage
  - 存储大小限制在4kb左右
  - 始终有效，窗口或浏览器关闭也一直保存，因此用作持久数据
  - 只能用document.localStorage来修改

## 浏览器缓存

- 强缓存
  - 不会向服务器发送请求，直接从缓存中读取资源
  - 返回状态码200，代表请求成功
  - 强缓存可以通过设置两种 HTTP Header 实现：Expires 和 Cache-Control
  - Expires 是 HTTP/1.0 时的规范，表示缓存到期时间
  - Cache-Control 是 HTTP/1.1 时的规范，表示缓存策略
- 协商缓存
  - 向服务器发送请求，服务器根据请求的 header 判断是否命中缓存，返回 304 或 200
  - 协商缓存可以通过设置两种 HTTP Header 实现：Last-Modified 和 ETag
  - Last-Modified 表示本地文件最后修改时间
  - ETag 表示文件的唯一标识（由服务器生成）
